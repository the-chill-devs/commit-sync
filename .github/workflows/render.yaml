name: Ping Render keep-alive

on:
    schedule:
        - cron: '*/10 * * * *'
    workflow_dispatch:

jobs:
    ping:
        runs-on: ubuntu-latest
        steps:
            - name: Ping Render service
              run: |
                echo "Pinging Render service at $(date)"
                RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" "${{ secrets.RENDER_PING_URL }}")
                
                if [ "$RESPONSE" -eq 200 ]; then
                  echo "✅ Ping successful! Status code: $RESPONSE"
                else
                  echo "❌ Ping failed with status code: $RESPONSE"
                  exit 1
                fi
                
            - name: Log timestamp
              run: echo "Last ping completed at $(date -u +"%Y-%m-%d %H:%M:%S UTC")"